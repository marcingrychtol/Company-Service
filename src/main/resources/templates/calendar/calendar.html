<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <div th:replace="fragments/bootstrap-styles"></div>

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css"/>

</head>
<body class="bg-light">
<div th:replace="fragments/nav-bar"></div>


<div class="container">
    <form th:action="@{/calendar}" th:object="${tripDto}">
                <div class="row justify-content-md-center">
                    <div class="col-12 col-md-8 col-lg-6 col-xl-4 p-4">
                        <div class="shadow card bg-danger text-white rounded-0">
                            <div class="card-header" th:text=
                                    "'Dziosio momy: '
                            + ${todayPlDay}
                            + ' '
                            + ${today}">Dziosio momy: </div>
                            <div class="card-body">
                                <label for="startDate">Zmiyń se dziyń: </label>
                                <input class="bg-light rounded-0" id="startDate" th:field="*{startingDate}"/>
                            </div>
                        </div>
                        <button type="submit" class="shadow btn btn-danger btn-block rounded-0">Ciś knefel
                        </button>
                    </div>
                </div>

    </form>


    <td th:unless="${successMessage} == null">
        <div class="alert alert-success alert-dismissible fade show rounded-0" role="alert">
            <p  th:text="${successMessage}"></p>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </td>

    <td th:unless="${errorMessage} == null">
        <div class="alert alert-danger alert-dismissible fade show rounded-0" role="alert">
            <p  th:text="${errorMessage}"></p>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </td>

    <div class="alert alert-dark alert-dismissible fade show mt-2 rounded-0" role="alert">
        <h1 class="display-4">Dostympne auta:</h1>
    </div>

    <div class="row">
        <tr th:each="car: ${cars}">
            <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1 mt-2">
                <div class="shadow card border-warning text-center rounded-0">
                    <h5 class="card-header bg-light">
                        <!--                        <td th:text="${car.getId()}"></td>-->
                        <td th:text="${car.getName()}"></td>
                    </h5>
                    <div class="card-body">
                        <p class="card-text">
                            <!--                        <td th:text="${car.getFuel()}"></td>-->
                            <!--                        <br>-->
                            <!--                        <td th:text="${car.getCarCategory()}"></td>-->
                            <!--                        <br>-->
                            <!--                        <td th:text="${car.getMileage()}"></td>-->
                            <!--                        <br>-->
                        <td th:text="${car.getRegistration()}"></td>
                        </p>
                    </div>
                    <a th:href="@{/trips/car/{id}(id=${car.getId()})}"
                       class="btn btn-warning stretched-link btn-block text-white rounded-0">Pokaż rezerwacje</a>
                </div>
            </div>
        </tr>
    </div>

    <div class="alert alert-dark alert-dismissible fade show mt-2 rounded-0" role="alert">
        <h1 class="display-4">Dzisio jadom:</h1>
    </div>

    <div class="row">
        <tr th:each="trip: ${trips}">
            <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1 mt-1 mb-1 h-100">
                <div class="shadow card border-info text-center rounded-0">
                    <h5 class="card-header bg-light">
                        <p class="card-text">
                        <td th:text="${trip.getCar().getName()}"></td>
                        <br>
                        <td th:text="${trip.getCar().getRegistration()}"></td>
                        </p>
                    </h5>
                    <div class="card-body">
                        <td th:text="'Od: ' + ${trip.getStartingDate().toLocaleString().split(',')[0]}"></td>
                        <br/>
                        <td th:text="'Do: ' + ${trip.getEndingDate().toLocaleString().split(',')[0]}"></td>
                        <p class="card-text mt-1">
                        <td th:text="${trip.getAdditionalMessage()}"></td>
                        </p>
                    </div>
                    <div class="card-footer">
                        <p class="card-text">
                        <td th:text="${trip.getEmployee().getName()}"></td>
                        <td th:text="${trip.getEmployee().getSecondName()}"></td>
                        <br/>
                        <td th:text="${trip.getEmployee().getPhoneNumber()}"></td>
                        </p>
                    </div>
                    <button type="submit" class="btn btn-info stretched-link rounded-0" value="add new employee">
                        Edytuj
                    </button>
                </div>
            </div>
        </tr>
    </div>
</div>

<div th:replace="fragments/bootstrap-scripts"></div>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<script th:inline="javascript">
    var today = new Date([(${year})], [(${month})], [(${day})]);

    $('#startDate').datepicker({
        showOnFocus: true,
        showRightIcon: false,
        header: false,
        format: 'dd/mm/yyyy',
        value: today.getDate().toString() + '/' + (today.getMonth()).toString() + '/' + today.getFullYear().toString(),
        uiLibrary: 'bootstrap4',
        iconsLibrary: 'fontawesome',

        maxDate: function () {
            return $('#endDate').val();
        }
    });
    $('#endDate').datepicker({
        showOnFocus: true,
        showRightIcon: false,
        header: false,
        format: 'dd/mm/yyyy',
        uiLibrary: 'bootstrap4',
        iconsLibrary: 'fontawesome',
        minDate: function () {
            return $('#startDate').val();
        }
    });
</script>
</body>
</html>