<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <div th:replace="fragments/bootstrap-styles"></div>
    <div th:replace="fragments/datepicker-styles"></div>

</head>
<body class="bg-light">
<div th:replace="fragments/nav-bar"></div>

<!-- filters below -->
<div class="container">
    <div class="row p-1 mt-2">
        <p>
            <a class="shadow btn btn-secondary btn-block  rounded-0" data-toggle="collapse" href="#collapseExample"
               role="button"
               aria-expanded="false" aria-controls="collapseExample">
                Filtrowanie
            </a>
        </p>
        <div class="collapse" id="collapseExample">
            <div class="shadow card card-body bg-secondary rounded-0">
                <form th:action="@{/trips/filter}" th:object="${tripDto}" method="post">
                    <div class="row">
                        <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1">
                            <div class="shadow card border-white rounded-0 h-100">
                                <div class="card-header">Dni</div>
                                <div class="card-body">
                                    <label for="startDate">≈Åod (abo yno): </label>
                                    <input class="bg-light rounded-0" id="startDate" th:field="*{startingDate}"/>
                                    <label for="endDate">Do: </label>
                                    <input class="bg-light rounded-0" placeholder="tego niy trza" id="endDate"
                                           th:field="*{endingDate}"/>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1">
                            <div class="shadow card border-white rounded-0 h-100">
                                <div class="card-header">Auto</div>
                                <div class="card-body">
                                    <select class="custom-select bg-light rounded-0" size="6" th:field="*{carId}">
                                        <option th:each="car : ${cars}" th:value="${car.getId()}"
                                                th:text="${car.getId()} + '. ' + ${car.getName()} + ' - ' + ${car.getRegistration()}">
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1">
                            <div class="shadow card border-white rounded-0 h-100">
                                <div class="card-header">Hajer</div>
                                <div class="card-body">
                                    <select class="custom-select bg-light  rounded-0" size="6" th:field="*{employeeId}">
                                        <option th:each="emp : ${employees}" th:value="${emp.getId()}"
                                                th:text="${emp.getId()} + '. ' + ${emp.getName()} + ' ' + ${emp.getSecondName()}">
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 col-md-6 col-lg-12 col-xl-3 p-1">
                            <div class="shadow card border-white rounded-0 h-100">
                                <div class="card-header">Opis</div>
                                <div class="card-body">
                            <textarea class="form-control bg-light rounded-0" rows="2"
                                      placeholder="Np. godziny wyjazdu, cel, klient..."
                                      th:field="*{additionalMessage}"></textarea>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="shadow btn btn-warning btn-block mt-3 rounded-0">Filtruj!
                        </button>

                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="row">

        <tr th:each="trip: ${trips}">
            <div class="col-12 col-md-6 col-lg-4 col-xl-3 p-1 mt-1 mb-1 h-100">
                <div class="shadow card border-info text-center rounded-0">
                    <h5 class="card-header bg-light">
                        <p class="card-text">
                        <td th:text="${trip.getCar().getName()}"></td>
                        <br>
                        <td th:text="${trip.getCar().getRegistration()}"></td>
                        </p>
                    </h5>
                    <div class="card-body">
                        <td th:text="'Od: ' + ${trip.getStartingDate().toLocaleString().split(',')[0]}"></td>
                        <br/>
                        <td th:text="'Do: ' + ${trip.getEndingDate().toLocaleString().split(',')[0]}"></td>
                        <p class="card-text mt-1">
                        <td th:text="${trip.getAdditionalMessage()}"></td>
                        </p>
                    </div>
                    <div class="card-footer">
                        <p class="card-text">
                        <td th:text="${trip.getEmployee().getName()}"></td>
                        <td th:text="${trip.getEmployee().getSecondName()}"></td>
                        <br/>
                        <td th:text="${trip.getEmployee().getPhoneNumber()}"></td>
                        </p>
                    </div>
                    <div class="card-footer">
                        <p class="card-text">
                        <td th:text="'Utworzono: ' + ${trip.getCreatedTime()}"></td><br/>
                        <td th:text="'Zmodyfikowano: ' + ${trip.getLastModifiedTime()}"></td>
                        </p>
                    </div>

                    <button type="submit" class="btn btn-info stretched-link rounded-0" value="add new employee">
                        Edytuj
                    </button>
                </div>
            </div>
        </tr>
    </div>

</div>

<div th:replace="fragments/bootstrap-scripts"></div>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<script>
    var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
    $('#startDate').datepicker({
        showOnFocus: true,
        showRightIcon: false,
        header: false,
        format: 'dd/mm/yyyy',
        value: today.getDate().toString() + '/' + (today.getMonth() + 1).toString() + '/' + today.getFullYear().toString(),
        uiLibrary: 'bootstrap4',
        iconsLibrary: 'fontawesome',
        minDate: today,

        maxDate: function () {
            return $('#endDate').val();
        }
    });
    $('#endDate').datepicker({
        showOnFocus: true,
        showRightIcon: false,
        header: false,
        format: 'dd/mm/yyyy',
        uiLibrary: 'bootstrap4',
        iconsLibrary: 'fontawesome',
        minDate: function () {
            return $('#startDate').val();
        }
    });
</script>
</body>
</html>